<%= form_tag do_record_payments_path, :class => 'form-horizontal' do %>
  <div class="form-group d-flex pb-3">
    <%= label_tag :account_id, 'Account ID', :class => 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <%= text_field_tag :account_id, @account_id, :class => 'form-control', :readonly => !@account_id.nil?, :required => true %>
    </div>
  </div>
  <div class="form-group d-flex pb-3">
    <%= label_tag :payment_amount, 'Amount Received', :class => 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <%= number_field_tag :payment_amount, nil, :step => :any, :id => 'payment_amount', :class => 'form-control', :required => true %>
      <p class="help-block mb-0">Currency: <%= @currency %></p>
    </div>
  </div>
  <div class="form-group d-flex pb-3">
    <%= label_tag :effective_date, 'Payment Date', :class => 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <%= text_field_tag :effective_date, Date.parse(Time.now.to_s).to_s, :class => 'form-control date-picker', :required => true, :data =>{:provide => 'datepicker', 'date-format': "yyyy-mm-dd"} %>
      </div>
  </div>
  <div class="form-group d-flex pb-3">
    <%= label_tag :payment_reference_number, 'Payment Ref. #', :class => 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <%= text_field_tag :payment_reference_number, nil, :class => 'form-control', :required => true %>
    </div>
  </div>
  <div class="form-group d-flex">
    <%= label_tag :deposit_type, 'Payment Mode', :class => 'col-sm-2 control-label' %>
    <div class="col-sm-10">
      <%= select_tag :deposit_type, options_for_select(Deposit.deposit_types), :class => 'form-control' %>
    </div>
  </div>

  <div id="invoices">
    <% unless @account_id.nil? %>
      <%= render(:partial => 'invoices_table') %>
    <% end %>
  </div>

  <div class="form-group d-flex justify-content-end pb-3">
    <%= render "kaui/components/button/button", {
      label: 'Save',
      variant: "outline-secondary d-inline-flex align-items-center gap-1",
      type: "submit",
      html_class: "kaui-dropdown custom-hover px-4",
      html_options: {
        id: "saveButton"
      }
    } %>
  </div>
<% end %>

<%= javascript_tag do %>
  $(document).ready(function() {
    $('#account_id').change(function() {
      $("#invoices").html("<%= j render(:partial => 'invoices_table') %>");
    });
  });
<% end %>
